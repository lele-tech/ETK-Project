---
import Layout from "../layouts/Layout.astro";
import Nav from "../components/Nav.astro";
import Stream from "../components/Stream.astro";
---

<Layout title="ETK Radio Stream">
  <main class="min-h-screen flex flex-col">
    <Nav />
    <div class="flex-1 flex flex-col items-center justify-center p-4 sm:p-6 lg:p-8">
      <div id="channelInfo" class="text-center mb-8 w-full max-w-4xl">
        <h1 id="channelName" class="text-3xl sm:text-4xl font-bold mb-4">ETK Radio</h1>
        <p id="channelSummary" class="text-lg mb-4">Live streaming channel for ETK content.</p>
        <p id="streamStatus" class="text-xl">Loading stream status...</p>
      </div>
      <Stream />
    </div>
  </main>
</Layout>

<style is:global>
  @import "../styles/global.css";
</style>

<script>
  const serverUrl = "http://192.168.100.14:8080";

  // Define fetches for status and config to be used in Stream component's loadData
  const statusRes = fetch(`${serverUrl}/api/status`);
  const configRes = fetch(`${serverUrl}/api/config`);
</script>
